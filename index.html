<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <link rel="manifest" href="/manifest.webmanifest" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nyvya IA Phone</title>
  <!-- Ic√¥nes PWA -->
  <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512.png" />
  <meta name="theme-color" content="#FFFFFF" />
  <style>
    body { font-family: system-ui,sans-serif; padding: 1em; }
    button { 
      margin: 5px 0; padding: 0.4em 1em; font-size: 1.1em; 
      border-radius: 20px; border: none; background: #edf0fa; color: #114;
      cursor: pointer; transition: 0.1s; box-shadow: 1px 1px 4px #0001;
      display: inline-block;
    }
    button:hover { background: #d5e6fa; }
    #zone { margin-top: 1.6em; }
    input, textarea { font-size: 1em; padding: 5px 10px; border-radius: 8px; border: 1px solid #ccc; }
    label { font-weight: bold; }
    textarea { width: 95%; min-height: 40px; margin-bottom: 10px; }
    .formzone { background: #f8faff; padding: 1em; border-radius: 15px; margin-bottom: 15px;}
  </style>
</head>
<body>
  <h1>Bienvenue sur Nyvya IA Phone‚ÄØ!</h1>
  <p>Choisis ce que tu veux faire üëá</p>

  <!-- MENU PRINCIPAL -->
  <button onclick="menu('histoire')">üìñ √âcouter une histoire IA</button><br>
  <button onclick="menu('berceuse')">üé∂ √âcouter une berceuse IA</button><br>
  <button onclick="menu('blague')">üòÇ Blague IA personnalis√©e</button><br>
  <button onclick="menu('traduction')">üåç Traduction instantan√©e</button><br>
  <button onclick="menu('actu')">üì∞ Actualit√© du jour</button><br>
  <button onclick="menu('jeu')">üß© Devinette / Jeu IA</button><br>
  <button onclick="menu('autre')">‚ú® Autre (√† venir)</button><br>

  <div id="zone"></div>

  <script>
    // Mets ici ta cl√© OpenAI (ou OpenRouter, compatible avec le endpoint OpenAI)
    const OPENAI_API_KEY = "COLLE_TA_CLE_OPENAI_ICI";

    function menu(type) {
      let html = "";
      if (type === "histoire") {
        html = `
        <div class="formzone">
          <h2>Raconte-moi une histoire IA personnalis√©e</h2>
          <label>Pr√©nom, √¢ge, envies, th√®me ou d√©tails particuliers :</label><br>
          <input id="cibleHistoire" style="width:85%;margin:10px 0" placeholder="ex: Sara, 11 mois, adore les papillons, ton apaisant" /><br>
          <button onclick="genererTexteIA('histoire')">G√©n√©rer l‚Äôhistoire IA</button>
        </div>
        <div id="resultHistoire" style="margin-top:1.5em"></div>
        <button onclick="menu('')">‚¨ÖÔ∏è Retour</button>
        `;
      }
      else if (type === "berceuse") {
        html = `
        <div class="section">
  <h2>Berceuse IA personnalis√©e</h2>
  <label for="input-berceuse">
    Pour qui ? <small>(pr√©nom, √¢ge, humeur, ambiance, bruit de fond, style‚Ä¶)</small>
  </label>
  <input id="input-berceuse" type="text" placeholder="ex‚ÄØ: Wharys, 7 ans, adore la mer, ambiance calme, bruit des vagues">
  <button id="btn-berceuse">G√©n√©rer la berceuse IA</button>
</div>
        <div id="resultBerceuse" style="margin-top:1.5em"></div>
        <button onclick="menu('')">‚¨ÖÔ∏è Retour</button>
        `;
      }
      else if (type === "blague") {
        html = `
        <div class="formzone">
          <h2>Blague personnalis√©e IA</h2>
          <label>Quel type de blague ? (public, sujet, style, pr√©nom‚Ä¶)</label><br>
          <input id="cibleBlague" style="width:85%;margin:10px 0" placeholder="ex: Blague courte pour un enfant de 6 ans sur les voitures" /><br>
          <button onclick="genererTexteIA('blague')">G√©n√©rer la blague IA</button>
        </div>
        <div id="resultBlague" style="margin-top:1.5em"></div>
        <button onclick="menu('')">‚¨ÖÔ∏è Retour</button>
        `;
      }
      else if (type === "traduction") {
        html = "<p>Fonction √† venir‚Ä¶</p><button onclick=\"menu('')\">‚¨ÖÔ∏è Retour</button>";
      }
      else if (type === "actu") {
        html = "<p>Fonction √† venir‚Ä¶</p><button onclick=\"menu('')\">‚¨ÖÔ∏è Retour</button>";
      }
      else if (type === "jeu") {
        html = "<p>Fonction √† venir‚Ä¶</p><button onclick=\"menu('')\">‚¨ÖÔ∏è Retour</button>";
      }
      else {
        html = "";
      }
      document.getElementById('zone').innerHTML = html;
    }

    // G√©n√©ration de texte IA pour Histoire, Berceuse, Blague
    async function genererTexteIA(type) {
      let cible = "";
      let prompt = "";
      let idResult = "";
      if (type === "histoire") {
        cible = document.getElementById("cibleHistoire").value;
        idResult = "resultHistoire";
        prompt = `√âcris une histoire originale, personnalis√©e, joyeuse et immersive, destin√©e √† : ${cible}. Sois cr√©atif et adapte vraiment le ton et les d√©tails √† la description, fais comme si c'√©tait invent√© sp√©cialement pour la personne, avec pr√©nom, √¢ge, envies, th√®mes ou bruitages si demand√©s.`;
      }
      else if (type === "berceuse") {
        cible = document.getElementById("cibleBerceuse").value;
        idResult = "resultBerceuse";
        prompt = `Invente une berceuse courte, douce, apaisante et personnalis√©e pour : ${cible}. Mets le pr√©nom dans la chanson et adapte l'ambiance (sons, style, bruit de fond si demand√©), pour que ce soit unique et fait sur-mesure √† la demande.`;
      }
      else if (type === "blague") {
        cible = document.getElementById("cibleBlague").value;
        idResult = "resultBlague";
        prompt = `Cr√©e une blague personnalis√©e adapt√©e √† : ${cible}. Garde un ton dr√¥le, adapt√© au public, et sois vraiment cr√©atif.`;
      }
      if (!cible) {
        alert("Merci de remplir la demande personnalis√©e !");
        return;
      }
      document.getElementById(idResult).innerHTML = "‚è≥ L‚ÄôIA g√©n√®re le texte en direct‚Ä¶";
      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + OPENAI_API_KEY
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [{role: "user", content: prompt}],
            max_tokens: 350,
            temperature: 0.9
          })
        });
        const data = await response.json();
        let texte = data.choices?.[0]?.message?.content || "Erreur lors de la g√©n√©ration.";
        document.getElementById(idResult).innerHTML = "<b>R√©sultat :</b><br><br>" + texte.replace(/\n/g, "<br>");
        parlerTexte(texte);
      } catch (err) {
        document.getElementById(idResult).innerHTML = "‚ùå Erreur lors de la g√©n√©ration.";
      }
    }

    // TTS navigateur (100% gratuit)
    function parlerTexte(text) {
      const synth = window.speechSynthesis;
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "fr-FR";
      synth.speak(utter);
    }
  </script>
</body>
</html>
