<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <link rel="manifest" href="/manifest.webmanifest" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nyvya IA Phone</title>
  <!-- IcÃ´nes PWA -->
  <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512.png" />
  <meta name="theme-color" content="#FFFFFF" />
</head>
<body>
  <h1>Bienvenue sur Nyvya IA Phoneâ€¯!</h1>
  <p>Choisis ce que tu veux faire ğŸ‘‡</p>

  <!-- MENU PRINCIPAL -->
  <button onclick="menu('histoire')">ğŸ“– Ã‰couter une histoire</button><br><br>
  <button onclick="menu('berceuse')">ğŸ¶ Ã‰couter une berceuse</button><br><br>
  <button onclick="menu('traduction')">ğŸŒ Traduction instantanÃ©e</button><br><br>
  <button onclick="menu('actu')">ğŸ“° ActualitÃ© du jour</button><br><br>
  <button onclick="menu('jeu')">ğŸ§© Devinette / Jeu IA</button><br><br>
  <button onclick="menu('blague')">ğŸ˜‚ Blague du jour</button><br><br>
  <button onclick="menu('autre')">âœ¨ Autre (Ã  venir)</button><br><br>

  <div id="zone"></div>

  <!-- AUDIO PLAYER POUR LA VOIX IA -->
  <audio id="nyvya-audio"></audio>

  <script>
    // --- SynthÃ¨se vocale ElevenLabs ---
    async function lireAvecTTS(text) {
      const apiKey  = 'sk_69d58535c7bc57ee86845c9944c62443cbd792665d17c79ba491'; // Mets ta clÃ© ici si tu changes
      const voiceId = '21m00Tcm4TlvDq8ikWAM'; // Rachel
      try {
        const res = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'xi-api-key': apiKey
          },
          body: JSON.stringify({ text })
        });
        if (!res.ok) throw new Error('TTS error ' + res.status);
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const audio = document.getElementById('nyvya-audio');
        audio.src = url;
        audio.play();
      } catch (err) {
        alert('Erreur TTS : ' + err.message);
        console.error(err);
      }
    }

    // --- Menus dynamiques ---
    function menu(type) {
      let html = "";
      if (type === "histoire") {
        html = `
          <h2>Choisis un thÃ¨me d'histoire</h2>
          <button onclick="alerteHistoire('pirates')">ğŸ´â€â˜ ï¸ Pirates</button>
          <button onclick="alerteHistoire('princesse')">ğŸ‘¸ Princesse</button>
          <button onclick="alerteHistoire('espace')">ğŸš€ Espace</button>
          <button onclick="alerteHistoire('animaux')">ğŸ» Animaux</button>
          <button onclick="menu('')">â¬…ï¸ Retour</button>
        `;
      }
      else if (type === "berceuse") {
        html = `
          <h2>Choisis une berceuse</h2>
          <button onclick="alerteBerceuse('douce nuit')">ğŸŒ™ Douce nuit</button>
          <button onclick="alerteBerceuse('etoiles')">â­ Berceuse des Ã©toiles</button>
          <button onclick="alerteBerceuse('ocÃ©an')">ğŸŒŠ RÃªve dâ€™ocÃ©an</button>
          <button onclick="menu('')">â¬…ï¸ Retour</button>
        `;
      }
      else if (type === "traduction") {
        html = "<p>Fonction Ã  venirâ€¦</p>";
      }
      else if (type === "actu") {
        html = "<p>Fonction Ã  venirâ€¦</p>";
      }
      else if (type === "jeu") {
        html = "<p>Fonction Ã  venirâ€¦</p>";
      }
      else if (type === "blague") {
        html = "<p>Fonction Ã  venirâ€¦</p>";
      }
      else {
        html = "";
      }
      document.getElementById('zone').innerHTML = html;
    }

    function alerteHistoire(theme) {
      alert("Histoire de " + theme + " : (Ã  venir)");
    }
    // --- Nouvelle fonction pour les berceuses ---
    function alerteBerceuse(theme) {
      if (theme === 'douce nuit') {
        lireAvecTTS("Dors, dors, mon petit trÃ©sor, la lune veille sur toi. Ferme les yeux, tout doucement, je te chante une douce berceuse.");
      } else if (theme === 'etoiles') {
        lireAvecTTS("Ferme les yeux, mon enfant, les Ã©toiles brillent rien que pour toi. Laisse-toi bercer tout doucement.");
      } else if (theme === 'ocÃ©an') {
        lireAvecTTS("Ã‰coute les vagues, mon bÃ©bÃ©, qui bercent ton sommeil. La mer te protÃ¨ge jusquâ€™au matin.");
      } else {
        alert("Berceuse : " + theme + " (Ã  venir)");
      }
    }
  </script>
</body>
</html>
